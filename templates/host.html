{% extends 'base.html' %}
{% block title %}Panel Hosta - {{ event.name }}{% endblock %}

{% block styles %}
<meta charset="UTF-8">
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/host_panel.css') }}">
{% endblock %}

{% block content %}
<div id="host-config"
     data-event-id="{{ event.id }}"
     data-is-superhost="{{ 'true' if is_superhost else 'false' }}"
     style="display: none;"></div>

<div class="container mt-4">
    {% if is_impersonated %}
    <div class="alert alert-warning d-flex justify-content-between align-items-center">
        <span data-translate="admin_impersonate">Jesteś zalogowany jako Admin w panelu Hosta.</span>
        <a href="{{ url_for('logout_impersonate') }}" class="btn btn-sm btn-warning" data-translate="back_to_admin">Powrót do panelu Admina</a>
    </div>
    {% endif %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="mb-0" data-translate="host_title">ORGANIZACJA GRY</h1>
            <h3 class="text-muted mb-0">{{ event.name }}</h3>
        </div>
        <a href="{{ url_for('display', event_id=event.id) }}" target="_blank" class="btn btn-outline-secondary" data-translate="open_display">Otwórz Ekran Gry</a>
    </div>

    <ul class="nav nav-tabs mb-4" id="hostTabs">
        <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#game" data-translate="tab_game">Gra</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#settings" data-translate="tab_settings">Ustawienia</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#timing" data-translate="tab_timing">Czas i tempo</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#players" data-translate="tab_players">Gracze</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#password" data-translate="tab_password">Hasło</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#display" data-translate="tab_display">Wyświetlacz</button></li>
        {% if is_superhost %}
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#qrcodes" data-translate="tab_qrcodes">Kody QR</button></li>
        {% endif %}
        <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#ar" data-translate="tab_ar">AR</button></li>
        <li class="nav-item"><button class="nav-link game-tab" data-bs-toggle="tab" data-bs-target="#questions" data-translate="tab_questions">Pytania runda 1</button></li>
        <li class="nav-item"><button class="nav-link game-tab" data-bs-toggle="tab" data-bs-target="#questions-r2">Pytania runda 2</button></li>
        <li class="nav-item"><button class="nav-link game-tab" data-bs-toggle="tab" data-bs-target="#questions-r3">Pytania runda 3</button></li>
        <li class="nav-item"><button class="nav-link game-tab" data-bs-toggle="tab" data-bs-target="#ai" data-translate="tab_ai">AI</button></li>
        <li class="nav-item"><button class="nav-link game-tab" data-bs-toggle="tab" data-bs-target="#fortune" data-translate="tab_fortune">Wróżka AI</button></li>
        <li class="nav-item"><button id="minigry-tab" class="nav-link game-tab" data-bs-toggle="tab" data-bs-target="#minigames" data-translate="tab_minigames">Minigry</button></li>
        <li class="nav-item"><button class="nav-link game-tab" data-bs-toggle="tab" data-bs-target="#photo" data-translate="tab_photo">Foto</button></li>
        <li class="nav-item"><button class="nav-link game-tab" data-bs-toggle="tab" data-bs-target="#voting" data-translate="tab_voting">Głosowanie</button></li>
        <li class="nav-item"><button class="nav-link game-tab" data-bs-toggle="tab" data-bs-target="#live" data-translate="tab_live">Na żywo</button></li>
    </ul>

    <div class="tab-content">
        <div class="tab-pane fade show active" id="game">
            {% include 'host/partials/_tab_game.html' %}
        </div>

        <div class="tab-pane fade" id="settings">
            {% include 'host/partials/_tab_settings.html' %}
        </div>

        {% if is_superhost %}
        <div class="tab-pane fade" id="qrcodes">
            {% include 'host/partials/_tab_qrcodes.html' %}
        </div>
        {% endif %}

        <div class="tab-pane fade" id="password">
            {% include 'host/partials/_tab_password.html' %}
        </div>

        <div class="tab-pane fade" id="players">
            {% include 'host/partials/_tab_players.html' %}
        </div>

        <div class="tab-pane fade" id="questions">
            {% include 'host/partials/_tab_questions.html' %}
        </div>

        <div class="tab-pane fade" id="ai">
            {% include 'host/partials/_tab_ai.html' %}
        </div>

        <!-- Pytania Runda 2 -->
        <div class="tab-pane fade" id="questions-r2">
            {% include 'host/partials/_tab_questions_r2.html' %}
        </div>

        <!-- Pytania Runda 3 -->
        <div class="tab-pane fade" id="questions-r3">
            {% include 'host/partials/_tab_questions_r3.html' %}
        </div>

        <div class="tab-pane fade" id="minigames">
            {% include 'host/partials/_tab_minigames.html' %}
        </div>

        <div class="tab-pane fade" id="photo">
            {% include 'host/partials/_tab_photo.html' %}
        </div>

        <div class="tab-pane fade" id="voting">
            {% include 'host/partials/_tab_voting.html' %}
        </div>

        <div class="tab-pane fade" id="live">
            {% include 'host/partials/_tab_live.html' %}
        </div>

        <div class="tab-pane fade" id="ar">
            {% include 'host/partials/_tab_ar.html' %}
        </div>

        <div class="tab-pane fade" id="fortune">
            {% include 'host/partials/_tab_fortune.html' %}
        </div>

        <div class="tab-pane fade" id="timing">
            <p style="background: red; color: white; padding: 20px; font-size: 24px;">TEST - Jeśli to widzisz, zakładka działa!</p>
            {% include 'host/partials/_tab_timing.html' %}
        </div>

        <!-- NOWA ZAKŁADKA: WYŚWIETLACZ -->
        <div class="tab-pane fade" id="display">
            {% include 'host/partials/_tab_display.html' %}
        </div>
    </div>
</div>

{% include 'host/partials/_modals.html' %}

{% endblock %}

{% block scripts %}
{{ super() }}
<script src="https://cdn.socket.io/4.5.2/socket.io.min.js"></script>
<script src="{{ url_for('static', filename='tetris.js') }}"></script>
<script src="{{ url_for('static', filename='arkanoid.js') }}"></script>
<script src="{{ url_for('static', filename='snake.js') }}"></script>
<script src="{{ url_for('static', filename='trex.js') }}"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

<script src="{{ url_for('static', filename='js/host/host_core.js') }}"></script>
<script src="{{ url_for('static', filename='js/host/host_players.js') }}"></script>
<script src="{{ url_for('static', filename='js/host/host_questions.js') }}"></script>
<script src="{{ url_for('static', filename='js/host/host_minigames.js') }}"></script>
<script src="{{ url_for('static', filename='js/host/host_live.js') }}"></script>
<script src="{{ url_for('static', filename='js/host/host_features.js') }}"></script>
{% endblock %}
